#磁盘分区和挂载
##挂载概念
>在linux操作系统中，挂载是一个非常重要的功能，使用非常频繁。**它指将一个设备（通常是存储设备）挂接到一个已存在的目录上**。需要理解的是，linux操作系统将所有的设备都看作文件，它将整个计算机的资源都整合成一个大的文件目录。我们要访问存储设备中的文件，**必须将文件所在的分区挂载到一个已存在的目录上，然后通过访问这个目录来访问存储设备**。

<img src="img/屏幕截图%202022-07-11%20164553.jpg">

##硬盘说明
Linux 硬盘分 IDE 硬盘和 SCSI 硬盘，目前基本上是 SCSI 硬盘
对于 SCSI 硬盘标识为“sdx~”，SCSI 硬盘是用“sd”来表示分区所在设备的类型的，x表示盘号，~表示分区
使用指令 **lsblk或lsblk-f** 来查看设备的挂载情况，如图：
<img src="img/屏幕截图%202022-07-11%20165614.jpg">

* **sda**是一块硬盘，sda1，sda2，sda3是它的三个分区，FSTYPE是文件系统格式
* **UUID**是分区的唯一标识符
* **MOUNTPOINT**是挂载点，是一个目录，指的是该分区被挂载到这个目录下，如果要访问该分区的的文件内容应该进入这个目录下 
##如何增加一块硬盘并挂载到指定目录
接下来介绍如何增加一块硬盘来扩充存储空间，主要有以下步骤
###1.虚拟机添加一块硬盘
首先在虚拟机的设置中选择添加硬盘，并设置硬盘大小，其它直接下一步。添加完成后再重启虚拟机，虚拟机就能识别到有一块新的硬盘被添加进来。
<img src="img/屏幕截图%202022-07-11%20171049.jpg">

###2.分区
执行分区命令： **fdisk /dev/sdb**
**说明: Linux中的设备都看作文件，/dev目录下的sdb对应的就是我们新添加的那块硬盘的文件**，开始分区后输入 n，新增分区，然后选择 p ，分区类型为主分区。两次回车默认剩余全部空间。**最后输入 w，写入分区并退出，若不保存退出输入 q**。
###3.格式化磁盘
此时硬盘还不能挂载到目录上，需要对磁盘格式化，即给磁盘的分区指定文件系统格式和分配一个唯一的UUID。
~~~Shell
//格式化磁盘sdb的第一个分区
mkfs -t ext4 /dev/sdb1
~~~
###4.挂载
将前面刚刚格式化的磁盘分区挂载到我们需要的目录，指令如下：
mount [设备文件] [挂载目录]
~~~Shell
mount /dev/sdb1 /newdisk
~~~
如果挂载到了错误的目录或者不想要挂载了可以用卸载指令
umout [设备文件] | [挂载目录] **(只需要写其中一个)**
~~~Shell
umount /dev/sdb1
~~~
###5.永久挂载
由于每次关机后，每个已挂载的文件都会被卸载，可以使用修改/etc/fstab中的内容来实现开机后自动挂载。如下是已修改好的文件内容.
<img src="img/屏幕截图%202022-07-11%20172651.jpg">

可以看到第一行是添加的内容，这样就实现了永久挂载。然后再用 **lsblk** 查看磁盘的挂载情况，可以看到sdb1被挂载到了/newdisk下
<img src="img/屏幕截图%202022-07-11%20173109.jpg">

##查看磁盘占用情况
###查看磁盘整体占用情况
基本语法：**df -h**
<img src="img/屏幕截图%202022-07-11%20175733.jpg">

其中 **vmhgfs-fuse**是我们设置的共享文件夹
###查看指定目录
指令格式：**du [选项] <--max-depth=n>(指定子目录深度) 查看的目录**
选项：
* -h 带计量单位
* -a 含文件
* -c 增加汇总值
~~~Shell
du -hac --max-depth=1 /home
~~~

##统计磁盘文件、目录
~~~Shell
//统计/opt 文件夹下文件的个数
ls -l /opt | grep "^-" | wc -l
//统计/opt 文件夹下目录的个数
ls -l /opt | grep "^d" | wc -l
//统计/opt 文件夹下文件的个数，包括子文件夹里的
ls -lR /opt | grep "^-" | wc -l
//统计/opt 文件夹下目录的个数，包括子文件夹里的
ls -lR /opt | grep "^d" | wc -l
//以树状结构显示目录，没有tree，使用 yum install tree安装
tree /home/
~~~
**解释：grep指令后跟一个正则表达式表示过滤出文件、目录，后面的wc -l表示统计结果总共有几行，即文件或目录的数量是多少**
